var RLib=(function(){var a={};a.hslider=function(c,f,h,l){h=h||function(u){return Math.round(u)};l=typeof l==="undefined"?false:l;var o={};c=$(c);var g=c.get(0);c.bind("contextmenu",function(){return false});$(document.body).keyup(function(){c.mouseleave();return true});c.addClass("rlib_slider").addClass("detach");var p=$("<div>").addClass("rlib_hfilled").appendTo(c);var r=$("<div>").addClass("rlib_limit").appendTo(c).css("width",c.height()+"px").css("margin-left","-"+c.height()/2+"px");var k=$("<div>").addClass("rlib_tip").appendTo(document.body);var t=0;var s=0;var m=false;var j=l;function n(u,v){if(!m){return}j=Math.max(0,Math.min(1,(u.pageX-c.offset().left)/c.get(0).offsetWidth));p.css("width",100*j+"%");k.text(h(j*t));k.css("top",(u.pageY-k.get(0).offsetHeight-(v||5))+"px");k.css("left",(u.pageX-k.get(0).offsetWidth/2)+"px")}function q(u){if(t<=0||!f){return}m=true;p.css("opacity",".8");k.css("display","block");n(u)}function e(u){if(t<=0||!f||!m){return}if(u&&u.button===2&&l!==false){f(l)}else{if(u){f(Math.max(0,Math.min(t,(u.pageX-c.offset().left)/c.get(0).offsetWidth*t)))}else{f(j*t)}}d()}function d(){m=false;p.css("opacity","1");k.css("display","none");i()}c.mouseover(q);c.mousemove(n);c.mouseleave(d);c.mouseup(e);g.addEventListener("touchstart",function(u){u.preventDefault();q(u.touches[0])},false);g.addEventListener("touchmove",function(u){u.preventDefault();n(u.touches[0],30)},false);g.addEventListener("touchend",function(u){u.preventDefault();e()},false);g.addEventListener("touchleave",function(u){u.preventDefault();e()},false);g.addEventListener("touchcancel",function(u){u.preventDefault();d()},false);o.setTotal=function(u){if(u!==t){t=u;i()}};o.setPosition=function(u){if(u!==s){s=u;i()}};function i(){if(m){return}if(t<=0){p.css("width","100%");r.css("left","200%")}else{var u=(100*s/t)+"%";p.css("width",u);r.css("left",u)}}return o};a.vmslider=function(f,g,z,v,e,q,D,l,t,d){var i=1,s=1;var c={};f=$(f);f.addClass("rlib_mslider").addClass("detach");var j=$("<canvas>").appendTo(f).attr("height",z*s).attr("width",g.length*i).get(0);var x=j.getContext("2d");var h=false,B=false,k=[];var u=$("<div>").addClass("rlib_tip").appendTo(document.body).css("opacity",0.8);var C=$("<div>").appendTo(f).addClass("zone");var p=C.get(0);C.bind("contextmenu",function(){return false});$(document.body).keyup(function(){n();return true});function y(E){h=true;u.css("display","block");w(E)}function w(F,G){if(!h){C.mouseover();return}var E=F.buttons&2?0.5:Math.max(0,Math.min(1,1-(F.pageY-f.offset().top)/f.get(0).offsetHeight));var H=Math.max(0,Math.min(g.length-1,Math.floor((F.pageX-f.offset().left)/f.get(0).offsetWidth*g.length)));u.html(D(H)+"<br/>"+q(E*z));u.css("top",(F.pageY-u.get(0).offsetHeight-(G||10))+"px");u.css("left",(F.pageX-u.get(0).offsetWidth/2)+"px");if(!B){r()}k[H]=E*z;o()}function n(){h=false;B=false;u.css("display","none");r();o()}function A(){B=true;return true}function m(F){if(F){F.buttons=F.button;w(F)}var E=[];k.forEach(function(H,I){var J=H,G=I;if(H!==g[I]){E.push(function(){l(G,J)})}});E.forEach(function(G){G()});n()}C.mouseover(y);C.mousemove(w);C.mouseleave(n);C.mousedown(A);C.mouseup(m);p.addEventListener("touchstart",function(E){E.preventDefault();A();y(E.touches[0])},false);p.addEventListener("touchmove",function(E){E.preventDefault();w(E.touches[0],30)},false);p.addEventListener("touchend",function(E){E.preventDefault();m()},false);p.addEventListener("touchleave",function(E){E.preventDefault();m()},false);p.addEventListener("touchcancel",function(E){E.preventDefault();n()},false);function r(){var E=g.length;while(E--){k[E]=g[E]}}function o(){if(Math.abs(f.get(0).offsetWidth-g.length*i/2)>2||Math.abs(f.get(0).offsetHeight-z*s/2)>2){i=f.get(0).offsetWidth/g.length*2;s=f.get(0).offsetHeight/z*2;j.width=i*g.length;j.height=s*z;x=j.getContext("2d")}x.clearRect(0,0,g.length*i,z*s);x.globalAlpha=0.8;x.strokeStyle=t;x.lineWidth=3;x.beginPath();x.moveTo(0,s*(z-v));x.lineTo(g.length*i,s*(z-v));x.stroke();x.globalAlpha=h?0.6:1;x.strokeStyle=d;x.lineWidth=e-1;x.lineCap="round";x.beginPath();x.moveTo(i/2,s*(z-k[0]));_.forEach(k,function(E,F){x.lineTo((F+0.5)*i,s*(z-E))});x.stroke();x.globalAlpha=1;x.fillStyle=t;_.forEach(g,function(E,F){x.fillRect((F+0.5)*i-e,s*(z-E)-e,e*2,e*2)})}c.set=function(F,E){g[F]=E;r();o()};c.setAll=function(E){_.each(E,function(F,G){l(G,F);c.set(G,F)})};c.setColors=function(F,E){t=F;d=E;o()};c.preview=function(E){var F=g.length;while(F--){k[F]=E[F]}h=true;o()};c.cancelPreview=n;r();o();c.update=o;return c};var b=(function(){var c=document.createElement("div");c.className="rlib_rating";[1,2,3,4,5].forEach(function(d){var e=document.createElement("div");e.appendChild(document.createTextNode("starBlack"));e.className="star";c.appendChild(e)});return c})();a.rating=function(e,d,g){var c={};c.el=b.cloneNode(true);c.el.addEventListener("contextmenu",function(h){h.preventDefault();c.setValue(0);g(0)},true);c.el.childNodes.forEach(function(i,h){i.addEventListener("click",function(){c.setValue(h+1);g(h+1)})});if(d===0){d=-1}else{d=Math.round(d)}e=Math.round(e)||0;function f(){if(d===-1){c.el.classList.remove("set")}else{c.el.classList.add("set")}var h=(d===-1?e:d);c.el.childNodes.forEach(function(k,j){if(h>j){k.classList.add("active")}else{k.classList.remove("active")}})}c.setValue=function(h){if(h===0){h=-1}else{h=Math.round(h)}if(h!==d){d=h;f()}};c.setDefault=function(h){h=Math.round(h)||0;if(h!==e){e=h;f()}};f();return c};return a})();