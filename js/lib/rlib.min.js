var RLib=(function(){var a={};a.hslider=function(b,e,g,k){g=g||function(t){return Math.round(t)};k=typeof k==="undefined"?false:k;var n={};b=$(b);var f=b.get(0);b.bind("contextmenu",function(){return false});$(document.body).keyup(function(){b.mouseleave();return true});b.addClass("rlib_slider").addClass("detach");var o=$("<div>").addClass("rlib_hfilled").appendTo(b);var q=$("<div>").addClass("rlib_limit").appendTo(b).css("width",b.height()+"px").css("margin-left","-"+b.height()/2+"px");var j=$("<div>").addClass("rlib_tip").appendTo(document.body);var s=0;var r=0;var l=false;var i=k;function m(t,u){if(!l){return}i=Math.max(0,Math.min(1,(t.pageX-b.offset().left)/b.get(0).offsetWidth));o.css("width",100*i+"%");j.text(g(i*s));j.css("top",(t.pageY-j.get(0).offsetHeight-(u||5))+"px");j.css("left",(t.pageX-j.get(0).offsetWidth/2)+"px")}function p(t){if(s<=0||!e){return}l=true;o.css("opacity",".8");j.css("display","block");m(t)}function d(t){if(s<=0||!e||!l){return}if(t&&t.button===2&&k!==false){e(k)}else{if(t){e(Math.max(0,Math.min(s,(t.pageX-b.offset().left)/b.get(0).offsetWidth*s)))}else{e(i*s)}}c()}function c(){l=false;o.css("opacity","1");j.css("display","none");h()}b.mouseover(p);b.mousemove(m);b.mouseleave(c);b.mouseup(d);f.addEventListener("touchstart",function(t){t.preventDefault();p(t.touches[0])},false);f.addEventListener("touchmove",function(t){t.preventDefault();m(t.touches[0],30)},false);f.addEventListener("touchend",function(t){t.preventDefault();d()},false);f.addEventListener("touchleave",function(t){t.preventDefault();d()},false);f.addEventListener("touchcancel",function(t){t.preventDefault();c()},false);n.setTotal=function(u){if(u!==s){s=u;h()}};n.setPosition=function(t){if(t!==r){r=t;h()}};function h(){if(l){return}if(s<=0){o.css("width","100%");q.css("left","200%")}else{var t=(100*r/s)+"%";o.css("width",t);q.css("left",t)}}return n};a.vmslider=function(e,f,y,u,d,p,C,k,s,c){var h=1,r=1;var b={};e=$(e);e.addClass("rlib_mslider").addClass("detach");var i=$("<canvas>").appendTo(e).attr("height",y*r).attr("width",f.length*h).get(0);var w=i.getContext("2d");var g=false,A=false,j=[];var t=$("<div>").addClass("rlib_tip").appendTo(document.body).css("opacity",0.8);var B=$("<div>").appendTo(e).addClass("zone");var o=B.get(0);B.bind("contextmenu",function(){return false});$(document.body).keyup(function(){m();return true});function x(D){g=true;t.css("display","block");v(D)}function v(E,F){if(!g){B.mouseover();return}var D=E.buttons&2?0.5:Math.max(0,Math.min(1,1-(E.pageY-e.offset().top)/e.get(0).offsetHeight));var G=Math.max(0,Math.min(f.length-1,Math.floor((E.pageX-e.offset().left)/e.get(0).offsetWidth*f.length)));t.html(C(G)+"<br/>"+p(D*y));t.css("top",(E.pageY-t.get(0).offsetHeight-(F||10))+"px");t.css("left",(E.pageX-t.get(0).offsetWidth/2)+"px");if(!A){q()}j[G]=D*y;n()}function m(){g=false;A=false;t.css("display","none");q();n()}function z(){A=true;return true}function l(E){if(E){E.buttons=E.button;v(E)}var D=[];j.forEach(function(G,H){var I=G,F=H;if(G!==f[H]){D.push(function(){k(F,I)})}});D.forEach(function(F){F()});m()}B.mouseover(x);B.mousemove(v);B.mouseleave(m);B.mousedown(z);B.mouseup(l);o.addEventListener("touchstart",function(D){D.preventDefault();z();x(D.touches[0])},false);o.addEventListener("touchmove",function(D){D.preventDefault();v(D.touches[0],30)},false);o.addEventListener("touchend",function(D){D.preventDefault();l()},false);o.addEventListener("touchleave",function(D){D.preventDefault();l()},false);o.addEventListener("touchcancel",function(D){D.preventDefault();m()},false);function q(){var D=f.length;while(D--){j[D]=f[D]}}function n(){if(Math.abs(e.get(0).offsetWidth-f.length*h/2)>2||Math.abs(e.get(0).offsetHeight-y*r/2)>2){h=e.get(0).offsetWidth/f.length*2;r=e.get(0).offsetHeight/y*2;i.width=h*f.length;i.height=r*y;w=i.getContext("2d")}w.clearRect(0,0,f.length*h,y*r);w.globalAlpha=0.8;w.strokeStyle=s;w.lineWidth=3;w.beginPath();w.moveTo(0,r*(y-u));w.lineTo(f.length*h,r*(y-u));w.stroke();w.globalAlpha=g?0.6:1;w.strokeStyle=c;w.lineWidth=d-1;w.lineCap="round";w.beginPath();w.moveTo(h/2,r*(y-j[0]));_.forEach(j,function(D,E){w.lineTo((E+0.5)*h,r*(y-D))});w.stroke();w.globalAlpha=1;w.fillStyle=s;_.forEach(f,function(D,E){w.fillRect((E+0.5)*h-d,r*(y-D)-d,d*2,d*2)})}b.set=function(E,D){f[E]=D;q();n()};b.setAll=function(D){_.each(D,function(E,F){k(F,E);b.set(F,E)})};b.setColors=function(E,D){s=E;c=D;n()};b.preview=function(D){var E=f.length;while(E--){j[E]=D[E]}g=true;n()};b.cancelPreview=m;q();n();b.update=n;return b};a.rating=function(c,e,d,g){c=$(c).addClass("rlib_rating");c.get(0).addEventListener("contextmenu",function(h){h.preventDefault();b.setValue(0);g(0);return false},true);if(d===0){d=-1}else{d=Math.round(d)}e=Math.round(e)||0;var b={};c.get(0).innerHTML='<div data-star="54321" class="star">starBlack</div><div data-star="5432" class="star">starBlack</div><div data-star="543" class="star">starBlack</div><div data-star="54" class="star">starBlack</div><div data-star="5" class="star">starBlack</div>';function f(){c.find(".star").removeClass("active");if(d===-1){c.removeClass("set");c.find(".star[data-star*="+e+"]").addClass("active")}else{c.addClass("set");c.find(".star[data-star*="+d+"]").addClass("active")}}b.setValue=function(h){if(h===0){h=-1}else{h=Math.round(h)}if(h!==d){d=h;f()}};b.setDefault=function(h){h=Math.round(h)||0;if(h!==e){e=h;f()}};f();return b};return a})();